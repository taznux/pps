<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/"/>
    <meta name="description" content="Using Web Frameworks for Scientific Applications">
    <meta name="keywords"
          content="web frameworks,MVC pattern,Flask installation,Flask input forms,Flask HTML templates,Flask MVC pattern,Flask troubleshooting,Django installation,Django making a project,Django making an application,Django input forms,Django HTML templates,Flask input forms,Flask error checking,Flask CSS style sheets,Flask LaTeX mathematics,Flask input validation,inline PNG image in HTML,base64 encoding of PNG images,inline SVG figure in HTML,mpld3 plotting,Flask Bokeh plotting,Bokeh plotting,highcharts,Flask login,Flask database,Flask uploading of files,Flask file upload,Django input forms,Django input validation">

    <title>Using Web Frameworks for Scientific Applications</title>


    <style type="text/css">
/* bloodish style */

body {
  font-family: Helvetica, Verdana, Arial, Sans-serif;
  color: #404040;
  background: #ffffff;
}
h1 { font-size: 1.8em;  color: #8A0808; }
h2 { font-size: 1.6em;  color: #8A0808; }
h3 { font-size: 1.4em;  color: #8A0808; }
h4 { color: #8A0808; }
a { color: #8A0808; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #bababa;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #f8f8f8;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_question.png); }

div { text-align: justify; text-justify: inter-word; }

    </style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Web frameworks', 1, None, '___sec0'),
              ('Other frameworks', 3, None, '___sec1'),
              ('The MVC pattern', 2, None, '___sec2'),
              ('A very simple application', 2, None, '___sec3'),
              ('Application of the MVC pattern', 2, 'wf:hw:mvc', 'wf:hw:mvc'),
              ('Making a Flask application', 1, None, '___sec5'),
              ('Programming the Flask application', 2, None, '___sec6'),
              ('The user interaction', 3, None, '___sec7'),
              ('The Python code', 3, None, '___sec8'),
              ('Dissection', 3, None, '___sec9'),
              ('The template files', 3, None, '___sec10'),
              ('Testing the application', 3, None, '___sec11'),
              ('Equipping the input page with output results',
               2,
               None,
               '___sec12'),
              ('Splitting the app into model, view, and controller files',
               2,
               'wf:hw3:flask',
               'wf:hw3:flask'),
              ('Troubleshooting', 2, None, '___sec14'),
              ('Address already in use', 3, None, '___sec15'),
              ('Making a Django application', 1, None, '___sec16'),
              ('Setting up a Django project', 2, None, '___sec17'),
              ('Setting up a Django application', 2, None, '___sec18'),
              ('Programming the Django application', 2, None, '___sec19'),
              ('The user interaction', 3, None, '___sec20'),
              ('The model', 3, None, '___sec21'),
              ('The view', 3, None, '___sec22'),
              ('Making the input page', 3, None, '___sec23'),
              ('Making the results page', 3, None, '___sec24'),
              ('Equipping the input page with output results',
               2,
               None,
               '___sec25'),
              ('Handling multiple input variables in Flask',
               1,
               'wf:vib:flask',
               'wf:vib:flask'),
              ('Programming the Flask application',
               2,
               'wf:vib1:flask:app',
               'wf:vib1:flask:app'),
              ('The compute part', 3, None, '___sec28'),
              ('The model', 3, None, '___sec29'),
              ('The view', 3, None, '___sec30'),
              ('The HTML template', 3, None, '___sec31'),
              ('Implementing error checking in the template',
               2,
               None,
               '___sec32'),
              ('Using style sheets', 2, None, '___sec33'),
              ('Using LaTeX mathematics', 2, None, '___sec34'),
              ('Rearranging the elements in the HTML template',
               2,
               None,
               '___sec35'),
              ('Bootstrap HTML style', 2, None, '___sec36'),
              ('Custom validation',
               2,
               'wf:vib1:flask:validation',
               'wf:vib1:flask:validation'),
              ('Using Flask validators', 3, None, '___sec38'),
              ('Tailored validation', 3, None, '___sec39'),
              ('Tailored validation of intervals', 3, None, '___sec40'),
              ('Demo', 3, None, '___sec41'),
              ('Avoiding plot files',
               2,
               'wf:vib2:flask:nofiles',
               'wf:vib2:flask:nofiles'),
              ('PNG plots', 3, None, '___sec43'),
              ('SVG plots', 3, None, '___sec44'),
              ('Using mpld3', 3, None, '___sec45'),
              ('Plotting with the Bokeh library',
               2,
               'wf:bokeh:flask',
               'wf:bokeh:flask'),
              ('Pandas highcharts plotting library', 3, None, '___sec47'),
              ('Autogenerating the code',
               2,
               'wf:autogen:flask',
               'wf:autogen:flask'),
              ('Inspecting function signatures', 3, None, '___sec49'),
              ('Generating the model', 3, None, '___sec50'),
              ('Generating the view', 3, None, '___sec51'),
              ('Generating the template', 3, None, '___sec52'),
              ('Application', 3, None, '___sec53'),
              ('User login and storage of computed results',
               2,
               'wf:flask:login',
               'wf:flask:login'),
              ('Required additional software', 3, None, '___sec55'),
              ('The compute part', 3, None, '___sec56'),
              ('The interfaces of the app', 3, None, '___sec57'),
              ('The source code', 3, None, '___sec58'),
              ('Resources', 3, None, '___sec59'),
              ('Uploading of files', 2, 'wf:flask:upload', 'wf:flask:upload'),
              ('Overview of the application', 3, None, '___sec61'),
              ('The model class', 3, None, '___sec62'),
              ('The controller file', 3, None, '___sec63'),
              ('The compute function', 3, None, '___sec64'),
              ('The HTML template', 3, None, '___sec65'),
              ('Handling multiple input variables in Django',
               1,
               'wf:vib:django',
               'wf:vib:django'),
              ('Programming the Django application', 2, None, '___sec67'),
              ('Adding the app to a project', 3, None, '___sec68'),
              ('The compute part', 3, None, '___sec69'),
              ('The model', 3, None, '___sec70'),
              ('The view', 3, None, '___sec71'),
              ('Custom validation', 2, None, '___sec72'),
              ('Customizing widgets', 2, None, '___sec73'),
              ('Resources', 2, None, '___sec74'),
              ('Exercises', 1, None, '___sec75'),
              ('Exercise 1: Add two numbers',
               2,
               'wf:exer:add2',
               'wf:exer:add2'),
              ('Exercise 2: Upload data file and visualize curves',
               2,
               'wf:exer:upload',
               'wf:exer:upload'),
              ('Exercise 3: Plot a user-specified formula',
               2,
               'wf:exer:formula',
               'wf:exer:formula'),
              ('Exercise 4: Visualize Taylor polynomial approximations',
               2,
               'wf:exer:Taylor',
               'wf:exer:Taylor'),
              ('Exercise 5: Extend the `gen` app',
               2,
               'wf:exer:gen:demo',
               'wf:exer:gen:demo'),
              ('Exercise 6: Make a web app with multiple apps',
               2,
               'wf:exer:addmul',
               'wf:exer:addmul'),
              ('Exercise 7: Equip the `gen` app with more data types',
               2,
               'wf:exer:gen:lists',
               'wf:exer:gen:lists'),
              ('Exercise 8: Auto-generate code from function signature',
               2,
               None,
               '___sec83'),
              ('Project 9: Interactive function exploration',
               2,
               'wf:exer:bokeh_UI',
               'wf:exer:bokeh_UI'),
              ('Resources', 1, None, '___sec85'),
              ('Flask resources', 2, None, '___sec86'),
              ('Django resources', 2, None, '___sec87')]}
end of tocinfo -->

<body>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});

</script>
<script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<a name="part0017"></a>
<p>
    <!-- begin top navigation -->
<table style="width: 100%">
    <tr>
        <td>
            <div style="text-align: left;"><a href="._web4sa_plain016.html">&laquo; Previous</a></div>
        </td>
        <td>
            <div style="text-align: right;"><a href="._web4sa_plain018.html">Next &raquo;</a></div>
        </td>
    </tr>
</table>
<!-- end top navigation -->
</p>

<p>
    <!-- !split -->

<h2 id="wf:flask:login">User login and storage of computed results</h2>

<p>
    We now want to make an app where the computed results can be stored in
    a database. To this end, each user must create an account and login to
    this account for archiving results and for browsing previous runs of
    the application. More files are needed for this purpose, compared to
    the previous apps, and the files are located in the <a
        href="https://github.com/hplgit/web4sciapps/tree/master/doc/src/web4sa/src-web4sa/apps/flask_apps/login"
        target="_self"><tt>login</tt></a> directory.

<h3 id="___sec55">Required additional software </h3>

<p>
    Three more packages are needed for this more advanced application:

<ul>
    <li><a href="https://flask-login.readthedocs.org/en/latest/" target="_self">Flask-Login</a></li>
    <li><a href="http://flask.pocoo.org/docs/0.10/patterns/sqlalchemy/" target="_self">Flask-SQLAlchemy</a></li>
    <li><a href="http://packages.python.org/Flask-Mail" target="_self">Flask-Mail</a></li>
</ul>

Installation is done by

<p>

    <!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">sudo pip install --upgrade flask-login
sudo pip install --upgrade flask-sqlalchemy
sudo pip install --upgrade flask-mail
</pre>
</div>

<h3 id="___sec56">The compute part </h3>

<p>
    The <code>compute.py</code> file contains the <code>compute</code>
    function from the <code>vib2</code> app in the section <a href="._web4sa_plain015.html#wf:vib2:flask:nofiles">Avoiding
    plot files</a>.

<p>
    There is quite much Flask code required for user accounts and login.
    The files here were generated by the Parampool package and then
    edited and specialized to the present application. In general,
    it is not recommended to hack further on the example given here,
    but rather utilize Parampool to generate web apps with user accounts
    and login.

<h3 id="___sec57">The interfaces of the app </h3>

<p>
    The first page after starting the app (<code>python controller.py</code>)
    shows input fields for the numerical parameters, but there are also
    links to the right for registering a new user or logging in to an
    existing account:

<p>
    <center>
<p><img src="fig-web4sa/login_main.png" align="bottom" width=700></p></center>

<p>
    Clicking on <em>Register</em> brings up a registration page:

<p>
    <center>
<p><img src="fig-web4sa/login_register.png" align="bottom" width=700></p></center>

<p>
    Already registered users can just log in:

<p>
    <center>
<p><img src="fig-web4sa/login_login.png" align="bottom" width=700></p></center>

<p>
    Then the fields with input parameters are shown again. After pressing
    <em>Compute</em> we are left with a combination of input and results, plus
    a field where the user can write a comment about this simulation:

<p>
    <center>
<p><img src="fig-web4sa/login_results.png" align="bottom" width=700></p></center>

<p>
    All simulations (input data, results, and comment) are stored in
    a database. Clicking on <em>Previous simulation</em> brings us to an
    overview of what is in the database:

<p>
    <center>
<p><img src="fig-web4sa/login_old.png" align="bottom" width=500></p></center>

<p>
    Here, one can browse previous results, remove entries, or erase the
    whole database.

<h3 id="___sec58">The source code </h3>

<p>
    Rather than explaining everything about the source code
    in detail, we primarily list
    the various code files below. A starting point is the central <code>controller.py</code>
    file, which is now quite lengthy and involves four different
    URLs (the input page, the login page, the registration page, and the
    previous results page).

<p>

    <!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span
        style="color: #008000; font-weight: bold">import</span> <span
        style="color: #0000FF; font-weight: bold">os</span>
<span style="color: #008000; font-weight: bold">from</span> <span
            style="color: #0000FF; font-weight: bold">compute</span> <span style="color: #008000; font-weight: bold">import</span> compute <span
            style="color: #008000; font-weight: bold">as</span> compute_function

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">flask</span> <span
            style="color: #008000; font-weight: bold">import</span> Flask, render_template, request, redirect, url_for
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">forms</span> <span
            style="color: #008000; font-weight: bold">import</span> ComputeForm
<span style="color: #008000; font-weight: bold">from</span> <span
            style="color: #0000FF; font-weight: bold">db_models</span> <span style="color: #008000; font-weight: bold">import</span> db, User, Compute
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">flask.ext.login</span> <span
            style="color: #008000; font-weight: bold">import</span> LoginManager, current_user, \
     login_user, logout_user, login_required
<span style="color: #008000; font-weight: bold">from</span> <span
            style="color: #0000FF; font-weight: bold">app</span> <span
            style="color: #008000; font-weight: bold">import</span> app

login_manager <span style="color: #666666">=</span> LoginManager()
login_manager<span style="color: #666666">.</span>init_app(app)

<span style="color: #AA22FF">@login_manager.user_loader</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">load_user</span>(user_id):
    <span style="color: #008000; font-weight: bold">return</span> db<span style="color: #666666">.</span>session<span
            style="color: #666666">.</span>query(User)<span style="color: #666666">.</span>get(user_id)

<span style="color: #408080; font-style: italic"># Path to the web application</span>
<span style="color: #AA22FF">@app.route</span>(<span style="color: #BA2121">&#39;/&#39;</span>, methods<span
            style="color: #666666">=</span>[<span style="color: #BA2121">&#39;GET&#39;</span>, <span
            style="color: #BA2121">&#39;POST&#39;</span>])
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">index</span>():
    result <span style="color: #666666">=</span> <span style="color: #008000">None</span>
    user <span style="color: #666666">=</span> current_user
    form <span style="color: #666666">=</span> ComputeForm(request<span style="color: #666666">.</span>form)
    <span style="color: #008000; font-weight: bold">if</span> request<span style="color: #666666">.</span>method <span
            style="color: #666666">==</span> <span style="color: #BA2121">&quot;POST&quot;</span>:
        <span style="color: #008000; font-weight: bold">if</span> form<span style="color: #666666">.</span>validate():

            result <span style="color: #666666">=</span> compute_function(form<span
            style="color: #666666">.</span>A<span style="color: #666666">.</span>data, form<span style="color: #666666">.</span>b<span
            style="color: #666666">.</span>data,
                                      form<span style="color: #666666">.</span>w<span style="color: #666666">.</span>data, form<span
            style="color: #666666">.</span>T<span style="color: #666666">.</span>data)
            <span style="color: #008000; font-weight: bold">if</span> user<span style="color: #666666">.</span>is_authenticated():
                <span style="color: #008000">object</span> <span style="color: #666666">=</span> Compute()
                form<span style="color: #666666">.</span>populate_obj(<span style="color: #008000">object</span>)
                <span style="color: #008000">object</span><span style="color: #666666">.</span>result <span
            style="color: #666666">=</span> result
                <span style="color: #008000">object</span><span style="color: #666666">.</span>user <span
            style="color: #666666">=</span> user
                db<span style="color: #666666">.</span>session<span style="color: #666666">.</span>add(<span
            style="color: #008000">object</span>)
                db<span style="color: #666666">.</span>session<span style="color: #666666">.</span>commit()

                <span style="color: #408080; font-style: italic"># Send email notification</span>
                <span style="color: #008000; font-weight: bold">if</span> user<span style="color: #666666">.</span>notify <span
            style="color: #AA22FF; font-weight: bold">and</span> user<span style="color: #666666">.</span>email:
                    send_email(user)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">if</span> user<span style="color: #666666">.</span>is_authenticated():
            <span style="color: #008000; font-weight: bold">if</span> user<span
            style="color: #666666">.</span>Compute<span style="color: #666666">.</span>count() <span
            style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
                instance <span style="color: #666666">=</span> user<span style="color: #666666">.</span>Compute<span
            style="color: #666666">.</span>order_by(<span style="color: #BA2121">&#39;-id&#39;</span>)<span
            style="color: #666666">.</span>first()
                result <span style="color: #666666">=</span> instance<span style="color: #666666">.</span>result
                form <span style="color: #666666">=</span> populate_form_from_instance(instance)

    <span style="color: #008000; font-weight: bold">return</span> render_template(<span style="color: #BA2121">&quot;view.html&quot;</span>, form<span
            style="color: #666666">=</span>form,
                           result<span style="color: #666666">=</span>result, user<span style="color: #666666">=</span>user)


<span style="color: #008000; font-weight: bold">def</span> <span
            style="color: #0000FF">populate_form_from_instance</span>(instance):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Repopulate form with previous values&quot;&quot;&quot;</span>
    form <span style="color: #666666">=</span> ComputeForm()
    <span style="color: #008000; font-weight: bold">for</span> field <span
            style="color: #AA22FF; font-weight: bold">in</span> form:
        field<span style="color: #666666">.</span>data <span style="color: #666666">=</span> <span
            style="color: #008000">getattr</span>(instance, field<span style="color: #666666">.</span>name)
    <span style="color: #008000; font-weight: bold">return</span> form

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">send_email</span>(user):
    <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">flask.ext.mail</span> <span
            style="color: #008000; font-weight: bold">import</span> Mail, Message
    mail <span style="color: #666666">=</span> Mail(app)
    msg <span style="color: #666666">=</span> Message(<span style="color: #BA2121">&quot;Compute Computations Complete&quot;</span>,
                  recipients<span style="color: #666666">=</span>[user<span style="color: #666666">.</span>email])
    msg<span style="color: #666666">.</span>body <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;&quot;</span>
<span style="color: #BA2121">A simulation has been completed by the Flask Compute app.</span>
<span style="color: #BA2121">Please log in at</span>

<span style="color: #BA2121">http://localhost:5000/login</span>

<span style="color: #BA2121">to see the results.</span>

<span style="color: #BA2121">---</span>
<span style="color: #BA2121">If you don&#39;t want email notifications when a result is found,</span>
<span style="color: #BA2121">please register a new user and leave the &#39;notify&#39; field</span>
<span style="color: #BA2121">unchecked.</span>
<span style="color: #BA2121">&quot;&quot;&quot;</span>
    mail<span style="color: #666666">.</span>send(msg)

<span style="color: #AA22FF">@app.route</span>(<span style="color: #BA2121">&#39;/reg&#39;</span>, methods<span
            style="color: #666666">=</span>[<span style="color: #BA2121">&#39;GET&#39;</span>, <span
            style="color: #BA2121">&#39;POST&#39;</span>])
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">create_login</span>():
    <span style="color: #008000; font-weight: bold">from</span> <span
            style="color: #0000FF; font-weight: bold">forms</span> <span style="color: #008000; font-weight: bold">import</span> register_form
    form <span style="color: #666666">=</span> register_form(request<span style="color: #666666">.</span>form)
    <span style="color: #008000; font-weight: bold">if</span> request<span style="color: #666666">.</span>method <span
            style="color: #666666">==</span> <span style="color: #BA2121">&#39;POST&#39;</span> <span
            style="color: #AA22FF; font-weight: bold">and</span> form<span style="color: #666666">.</span>validate():
        user <span style="color: #666666">=</span> User()
        form<span style="color: #666666">.</span>populate_obj(user)
        user<span style="color: #666666">.</span>set_password(form<span style="color: #666666">.</span>password<span
            style="color: #666666">.</span>data)

        db<span style="color: #666666">.</span>session<span style="color: #666666">.</span>add(user)
        db<span style="color: #666666">.</span>session<span style="color: #666666">.</span>commit()

        login_user(user)
        <span style="color: #008000; font-weight: bold">return</span> redirect(url_for(<span style="color: #BA2121">&#39;index&#39;</span>))
    <span style="color: #008000; font-weight: bold">return</span> render_template(<span style="color: #BA2121">&quot;reg.html&quot;</span>, form<span
            style="color: #666666">=</span>form)

<span style="color: #AA22FF">@app.route</span>(<span style="color: #BA2121">&#39;/login&#39;</span>, methods<span
            style="color: #666666">=</span>[<span style="color: #BA2121">&#39;GET&#39;</span>, <span
            style="color: #BA2121">&#39;POST&#39;</span>])
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">login</span>():
    <span style="color: #008000; font-weight: bold">from</span> <span
            style="color: #0000FF; font-weight: bold">forms</span> <span style="color: #008000; font-weight: bold">import</span> login_form
    form <span style="color: #666666">=</span> login_form(request<span style="color: #666666">.</span>form)
    <span style="color: #008000; font-weight: bold">if</span> request<span style="color: #666666">.</span>method <span
            style="color: #666666">==</span> <span style="color: #BA2121">&#39;POST&#39;</span> <span
            style="color: #AA22FF; font-weight: bold">and</span> form<span style="color: #666666">.</span>validate():
        user <span style="color: #666666">=</span> form<span style="color: #666666">.</span>get_user()
        login_user(user)
        <span style="color: #008000; font-weight: bold">return</span> redirect(url_for(<span style="color: #BA2121">&#39;index&#39;</span>))
    <span style="color: #008000; font-weight: bold">return</span> render_template(<span style="color: #BA2121">&quot;login.html&quot;</span>, form<span
            style="color: #666666">=</span>form)

<span style="color: #AA22FF">@app.route</span>(<span style="color: #BA2121">&#39;/logout&#39;</span>)
<span style="color: #AA22FF">@login_required</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">logout</span>():
    logout_user()
    <span style="color: #008000; font-weight: bold">return</span> redirect(url_for(<span style="color: #BA2121">&#39;index&#39;</span>))

<span style="color: #AA22FF">@app.route</span>(<span style="color: #BA2121">&#39;/old&#39;</span>)
<span style="color: #AA22FF">@login_required</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">old</span>():
    data <span style="color: #666666">=</span> []
    user <span style="color: #666666">=</span> current_user
    <span style="color: #008000; font-weight: bold">if</span> user<span style="color: #666666">.</span>is_authenticated():
        instances <span style="color: #666666">=</span> user<span style="color: #666666">.</span>Compute<span
            style="color: #666666">.</span>order_by(<span style="color: #BA2121">&#39;-id&#39;</span>)<span
            style="color: #666666">.</span>all()
        <span style="color: #008000; font-weight: bold">for</span> instance <span
            style="color: #AA22FF; font-weight: bold">in</span> instances:
            form <span style="color: #666666">=</span> populate_form_from_instance(instance)

            result <span style="color: #666666">=</span> instance<span style="color: #666666">.</span>result
            <span style="color: #008000; font-weight: bold">if</span> instance<span style="color: #666666">.</span>comments:
                comments <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&lt;h3&gt;Comments&lt;/h3&gt;&quot;</span> <span
            style="color: #666666">+</span> instance<span style="color: #666666">.</span>comments
            <span style="color: #008000; font-weight: bold">else</span>:
                comments <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&#39;</span>
            data<span style="color: #666666">.</span>append(
                {<span style="color: #BA2121">&#39;form&#39;</span>:form, <span
            style="color: #BA2121">&#39;result&#39;</span>:result,
                 <span style="color: #BA2121">&#39;id&#39;</span>:instance<span style="color: #666666">.</span>id, <span
            style="color: #BA2121">&#39;comments&#39;</span>: comments})

    <span style="color: #008000; font-weight: bold">return</span> render_template(<span style="color: #BA2121">&quot;old.html&quot;</span>, data<span
            style="color: #666666">=</span>data)

<span style="color: #AA22FF">@app.route</span>(<span style="color: #BA2121">&#39;/add_comment&#39;</span>, methods<span
            style="color: #666666">=</span>[<span style="color: #BA2121">&#39;GET&#39;</span>, <span
            style="color: #BA2121">&#39;POST&#39;</span>])
<span style="color: #AA22FF">@login_required</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add_comment</span>():
    user <span style="color: #666666">=</span> current_user
    <span style="color: #008000; font-weight: bold">if</span> request<span style="color: #666666">.</span>method <span
            style="color: #666666">==</span> <span style="color: #BA2121">&#39;POST&#39;</span> <span
            style="color: #AA22FF; font-weight: bold">and</span> user<span style="color: #666666">.</span>is_authenticated():
        instance <span style="color: #666666">=</span> user<span style="color: #666666">.</span>Compute<span
            style="color: #666666">.</span>order_by(<span style="color: #BA2121">&#39;-id&#39;</span>)<span
            style="color: #666666">.</span>first()
        instance<span style="color: #666666">.</span>comments <span style="color: #666666">=</span> request<span
            style="color: #666666">.</span>form<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;comments&quot;</span>, <span
            style="color: #008000">None</span>)
        db<span style="color: #666666">.</span>session<span style="color: #666666">.</span>commit()
    <span style="color: #008000; font-weight: bold">return</span> redirect(url_for(<span style="color: #BA2121">&#39;index&#39;</span>))

<span style="color: #AA22FF">@app.route</span>(<span style="color: #BA2121">&#39;/delete/&lt;id&gt;&#39;</span>, methods<span
            style="color: #666666">=</span>[<span style="color: #BA2121">&#39;GET&#39;</span>, <span
            style="color: #BA2121">&#39;POST&#39;</span>])
<span style="color: #AA22FF">@login_required</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">delete_post</span>(<span
            style="color: #008000">id</span>):
    <span style="color: #008000">id</span> <span style="color: #666666">=</span> <span style="color: #008000">int</span>(<span
            style="color: #008000">id</span>)
    user <span style="color: #666666">=</span> current_user
    <span style="color: #008000; font-weight: bold">if</span> user<span style="color: #666666">.</span>is_authenticated():
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">id</span> <span
            style="color: #666666">==</span> <span style="color: #666666">-1</span>:
            instances <span style="color: #666666">=</span> user<span style="color: #666666">.</span>Compute<span
            style="color: #666666">.</span>delete()
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000; font-weight: bold">try</span>:
                instance <span style="color: #666666">=</span> user<span style="color: #666666">.</span>Compute<span
            style="color: #666666">.</span>filter_by(<span style="color: #008000">id</span><span style="color: #666666">=</span><span
            style="color: #008000">id</span>)<span style="color: #666666">.</span>first()
                db<span style="color: #666666">.</span>session<span style="color: #666666">.</span>delete(instance)
            <span style="color: #008000; font-weight: bold">except</span>:
                <span style="color: #008000; font-weight: bold">pass</span>

        db<span style="color: #666666">.</span>session<span style="color: #666666">.</span>commit()
    <span style="color: #008000; font-weight: bold">return</span> redirect(url_for(<span style="color: #BA2121">&#39;old&#39;</span>))


<span style="color: #008000; font-weight: bold">if</span> __name__ <span style="color: #666666">==</span> <span
            style="color: #BA2121">&#39;__main__&#39;</span>:
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span
            style="color: #666666">.</span>path<span style="color: #666666">.</span>isfile(os<span
            style="color: #666666">.</span>path<span style="color: #666666">.</span>join(
        os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>dirname(__file__), <span
            style="color: #BA2121">&#39;sqlite.db&#39;</span>)):
        db<span style="color: #666666">.</span>create_all()
    app<span style="color: #666666">.</span>run(debug<span style="color: #666666">=</span><span style="color: #008000">True</span>)
</pre>
</div>
<p>
    <!-- We need to copy the app code since it contains the password to -->
    <!-- an existing gmail account. -->

<p>
    Creation of the <code>app</code> object is put in a separate file <code>app.py</code>:

<p>

    <!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span
        style="color: #008000; font-weight: bold">import</span> <span
        style="color: #0000FF; font-weight: bold">os</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">flask</span> <span
            style="color: #008000; font-weight: bold">import</span> Flask

app <span style="color: #666666">=</span> Flask(__name__)
app<span style="color: #666666">.</span>config[<span
            style="color: #BA2121">&#39;SQLALCHEMY_DATABASE_URI&#39;</span>] <span style="color: #666666">=</span> <span
            style="color: #BA2121">&#39;sqlite:///sqlite.db&#39;</span>
app<span style="color: #666666">.</span>secret_key <span style="color: #666666">=</span> os<span style="color: #666666">.</span>urandom(<span
            style="color: #666666">24</span>)

<span style="color: #408080; font-style: italic"># Email settings</span>
<span style="color: #008000; font-weight: bold">import</span> <span
            style="color: #0000FF; font-weight: bold">base64</span>
app<span style="color: #666666">.</span>config<span style="color: #666666">.</span>update(
        MAIL_SERVER<span style="color: #666666">=</span><span style="color: #BA2121">&#39;smtp.gmail.com&#39;</span>,
        MAIL_PORT<span style="color: #666666">=587</span>,
        MAIL_USE_TLS<span style="color: #666666">=</span><span style="color: #008000">True</span>,
        MAIL_USERNAME <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;cbcwebsolvermail@gmail.com&#39;</span>,
        MAIL_PASSWORD <span style="color: #666666">=</span> base64<span
            style="color: #666666">.</span>decodestring(<span style="color: #BA2121">&#39;WGlmZmljdox0UFch&#39;</span>),
        MAIL_DEFAULT_SENDER <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;Some name &lt;name@gmail.com&gt;&#39;</span>
        )
</pre>
</div>
<p>
    The forms for the compute function and for the login is
    stored in a file called <code>forms.py</code>:

<p>

    <!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span
        style="color: #008000; font-weight: bold">import</span> <span
        style="color: #0000FF; font-weight: bold">wtforms</span> <span
        style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">wtf</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span
            style="color: #008000; font-weight: bold">import</span> pi

<span style="color: #008000; font-weight: bold">class</span> <span
            style="color: #0000FF; font-weight: bold">ComputeForm</span>(wtf<span style="color: #666666">.</span>Form):
    A <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>FloatField(label<span
            style="color: #666666">=</span><span style="color: #BA2121">&#39;\( A \)&#39;</span>, default<span
            style="color: #666666">=1.0</span>,
        validators<span style="color: #666666">=</span>[wtf<span style="color: #666666">.</span>validators<span
            style="color: #666666">.</span>InputRequired()])
    b <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>FloatField(label<span
            style="color: #666666">=</span><span style="color: #BA2121">&#39;\( b \)&#39;</span>, default<span
            style="color: #666666">=0.0</span>,
        validators<span style="color: #666666">=</span>[wtf<span style="color: #666666">.</span>validators<span
            style="color: #666666">.</span>InputRequired()])
    w <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>FloatField(label<span
            style="color: #666666">=</span><span style="color: #BA2121">&#39;\( w \)&#39;</span>, default<span
            style="color: #666666">=</span>pi,
        validators<span style="color: #666666">=</span>[wtf<span style="color: #666666">.</span>validators<span
            style="color: #666666">.</span>InputRequired()])
    T <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>FloatField(label<span
            style="color: #666666">=</span><span style="color: #BA2121">&#39;\( T \)&#39;</span>, default<span
            style="color: #666666">=18</span>,
        validators<span style="color: #666666">=</span>[wtf<span style="color: #666666">.</span>validators<span
            style="color: #666666">.</span>InputRequired()])
    resolution <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>IntegerField(label<span
            style="color: #666666">=</span><span style="color: #BA2121">&#39;resolution&#39;</span>, default<span
            style="color: #666666">=500</span>,
        validators<span style="color: #666666">=</span>[wtf<span style="color: #666666">.</span>validators<span
            style="color: #666666">.</span>InputRequired()])

<span style="color: #008000; font-weight: bold">from</span> <span
            style="color: #0000FF; font-weight: bold">db_models</span> <span style="color: #008000; font-weight: bold">import</span> db, User
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">flask.ext.wtf.html5</span> <span
            style="color: #008000; font-weight: bold">as</span> <span
            style="color: #0000FF; font-weight: bold">html5</span>

<span style="color: #408080; font-style: italic"># Standard Forms</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">register_form</span>(wtf<span
            style="color: #666666">.</span>Form):
    username <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>TextField(
        label<span style="color: #666666">=</span><span
            style="color: #BA2121">&#39;Username&#39;</span>, validators<span style="color: #666666">=</span>[wtf<span
            style="color: #666666">.</span>validators<span style="color: #666666">.</span>Required()])
    password <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>PasswordField(
        label<span style="color: #666666">=</span><span
            style="color: #BA2121">&#39;Password&#39;</span>, validators<span style="color: #666666">=</span>[
            wtf<span style="color: #666666">.</span>validators<span style="color: #666666">.</span>Required(),
            wtf<span style="color: #666666">.</span>validators<span style="color: #666666">.</span>EqualTo(
                <span style="color: #BA2121">&#39;confirm&#39;</span>, message<span style="color: #666666">=</span><span
            style="color: #BA2121">&#39;Passwords must match&#39;</span>)])
    confirm  <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>PasswordField(
        label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Confirm Password&#39;</span>,
        validators<span style="color: #666666">=</span>[wtf<span style="color: #666666">.</span>validators<span
            style="color: #666666">.</span>Required()])
    email    <span style="color: #666666">=</span> html5<span style="color: #666666">.</span>EmailField(label<span
            style="color: #666666">=</span><span style="color: #BA2121">&#39;Email&#39;</span>)
    notify   <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>BooleanField(label<span
            style="color: #666666">=</span><span style="color: #BA2121">&#39;Email notifications&#39;</span>)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">validate</span>(<span
            style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">if</span> <span
            style="color: #AA22FF; font-weight: bold">not</span> wtf<span style="color: #666666">.</span>Form<span
            style="color: #666666">.</span>validate(<span style="color: #008000">self</span>):
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>

        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span
            style="color: #666666">.</span>notify<span style="color: #666666">.</span>data <span
            style="color: #AA22FF; font-weight: bold">and</span> <span
            style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span
            style="color: #666666">.</span>email<span style="color: #666666">.</span>data:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>notify<span
            style="color: #666666">.</span>errors<span style="color: #666666">.</span>append(
        <span style="color: #BA2121">&#39;Cannot send notifications without a valid email address&#39;</span>)
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>

        <span style="color: #008000; font-weight: bold">if</span> db<span style="color: #666666">.</span>session<span
            style="color: #666666">.</span>query(User)<span style="color: #666666">.</span>filter_by(
            username<span style="color: #666666">=</span><span style="color: #008000">self</span><span
            style="color: #666666">.</span>username<span style="color: #666666">.</span>data)<span
            style="color: #666666">.</span>count() <span style="color: #666666">&gt;</span> <span
            style="color: #666666">0</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>username<span
            style="color: #666666">.</span>errors<span style="color: #666666">.</span>append(<span
            style="color: #BA2121">&#39;User already exists&#39;</span>)
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>

        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">class</span> <span
            style="color: #0000FF; font-weight: bold">login_form</span>(wtf<span style="color: #666666">.</span>Form):
    username <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>TextField(
        label<span style="color: #666666">=</span><span
            style="color: #BA2121">&#39;Username&#39;</span>, validators<span style="color: #666666">=</span>[wtf<span
            style="color: #666666">.</span>validators<span style="color: #666666">.</span>Required()])
    password <span style="color: #666666">=</span> wtf<span style="color: #666666">.</span>PasswordField(
        label<span style="color: #666666">=</span><span
            style="color: #BA2121">&#39;Password&#39;</span>, validators<span style="color: #666666">=</span>[wtf<span
            style="color: #666666">.</span>validators<span style="color: #666666">.</span>Required()])

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">validate</span>(<span
            style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">if</span> <span
            style="color: #AA22FF; font-weight: bold">not</span> wtf<span style="color: #666666">.</span>Form<span
            style="color: #666666">.</span>validate(<span style="color: #008000">self</span>):
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>

        user <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>get_user()

        <span style="color: #008000; font-weight: bold">if</span> user <span style="color: #AA22FF; font-weight: bold">is</span> <span
            style="color: #008000">None</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>username<span
            style="color: #666666">.</span>errors<span style="color: #666666">.</span>append(<span
            style="color: #BA2121">&#39;Unknown username&#39;</span>)
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>

        <span style="color: #008000; font-weight: bold">if</span> <span
            style="color: #AA22FF; font-weight: bold">not</span> user<span style="color: #666666">.</span>check_password(<span
            style="color: #008000">self</span><span style="color: #666666">.</span>password<span style="color: #666666">.</span>data):
            <span style="color: #008000">self</span><span style="color: #666666">.</span>password<span
            style="color: #666666">.</span>errors<span style="color: #666666">.</span>append(<span
            style="color: #BA2121">&#39;Invalid password&#39;</span>)
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>

        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">True</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_user</span>(<span
            style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> db<span
            style="color: #666666">.</span>session<span style="color: #666666">.</span>query(User)<span
            style="color: #666666">.</span>filter_by(
            username<span style="color: #666666">=</span><span style="color: #008000">self</span><span
            style="color: #666666">.</span>username<span style="color: #666666">.</span>data)<span
            style="color: #666666">.</span>first()
</pre>
</div>
<p>
    Database-related code for the SQLAlchemy database is collected in
    <code>db_models.py</code>:

<p>

    <!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span
        style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">flask.ext.sqlalchemy</span> <span
        style="color: #008000; font-weight: bold">import</span> SQLAlchemy
<span style="color: #008000; font-weight: bold">from</span> <span
            style="color: #0000FF; font-weight: bold">werkzeug</span> <span style="color: #008000; font-weight: bold">import</span> generate_password_hash, check_password_hash
<span style="color: #008000; font-weight: bold">from</span> <span
            style="color: #0000FF; font-weight: bold">app</span> <span
            style="color: #008000; font-weight: bold">import</span> app

db <span style="color: #666666">=</span> SQLAlchemy(app)

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">User</span>(db<span
            style="color: #666666">.</span>Model):
    <span style="color: #008000">id</span> <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>Integer, primary_key<span style="color: #666666">=</span><span
            style="color: #008000">True</span>)
    username <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String(<span style="color: #666666">50</span>), unique<span
            style="color: #666666">=</span><span style="color: #008000">True</span>)
    pwhash <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String())
    email <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String(<span style="color: #666666">120</span>), nullable<span
            style="color: #666666">=</span><span style="color: #008000">True</span>)
    notify <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>Boolean())

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__repr__</span>(<span
            style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;&lt;User </span><span
            style="color: #BB6688; font-weight: bold">%r</span><span style="color: #BA2121">&gt;&#39;</span> <span
            style="color: #666666">%</span> (<span style="color: #008000">self</span><span
            style="color: #666666">.</span>username)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">check_password</span>(<span
            style="color: #008000">self</span>, pw):
        <span style="color: #008000; font-weight: bold">return</span> check_password_hash(<span style="color: #008000">self</span><span
            style="color: #666666">.</span>pwhash, pw)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">set_password</span>(<span
            style="color: #008000">self</span>, pw):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>pwhash <span
            style="color: #666666">=</span> generate_password_hash(pw)

    <span style="color: #008000; font-weight: bold">def</span> <span
            style="color: #0000FF">is_authenticated</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">True</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">is_active</span>(<span
            style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">True</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">is_anonymous</span>(<span
            style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_id</span>(<span
            style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span
            style="color: #666666">.</span>id

<span style="color: #008000; font-weight: bold">class</span> <span
            style="color: #0000FF; font-weight: bold">Compute</span>(db<span style="color: #666666">.</span>Model):
    <span style="color: #008000">id</span> <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>Integer, primary_key<span style="color: #666666">=</span><span
            style="color: #008000">True</span>)

    A <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String())
    b <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String())
    w <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String())
    T <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String())
    resolution <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>Integer)

    result <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String())
    comments <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>String(), nullable<span style="color: #666666">=</span><span
            style="color: #008000">True</span>)
    user_id <span style="color: #666666">=</span> db<span style="color: #666666">.</span>Column(db<span
            style="color: #666666">.</span>Integer, db<span style="color: #666666">.</span>ForeignKey(<span
            style="color: #BA2121">&#39;user.id&#39;</span>))
    user <span style="color: #666666">=</span> db<span style="color: #666666">.</span>relationship(<span
            style="color: #BA2121">&#39;User&#39;</span>,
           backref<span style="color: #666666">=</span>db<span style="color: #666666">.</span>backref(<span
            style="color: #BA2121">&#39;Compute&#39;</span>, lazy<span style="color: #666666">=</span><span
            style="color: #BA2121">&#39;dynamic&#39;</span>))
</pre>
</div>
<p>
    Finally, we need views. For the results of the computation we have
    a <code>view.html</code> file that is very similar to <code>view_table.html</code>
    in the <code>vib1</code> app:

<p>

    <!-- code=html (!bc htmlpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BC7A00">&lt;!DOCTYPE html&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;html</span> <span style="color: #7D9029">lang=</span><span
            style="color: #BA2121">&quot;en&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;head&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;meta</span> <span style="color: #7D9029">charset=</span><span
            style="color: #BA2121">&quot;utf-8&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;title&gt;</span>Flask Vib app<span
            style="color: #008000; font-weight: bold">&lt;/title&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;/head&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;body&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;script </span><span style="color: #7D9029">type=</span><span
            style="color: #BA2121">&quot;text/x-mathjax-config&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
MathJax.Hub.Config({
  TeX<span style="color: #666666">:</span> {
     equationNumbers<span style="color: #666666">:</span> {  autoNumber<span style="color: #666666">:</span> <span
            style="color: #BA2121">&quot;AMS&quot;</span>  },
     extensions<span style="color: #666666">:</span> [<span style="color: #BA2121">&quot;AMSmath.js&quot;</span>, <span
            style="color: #BA2121">&quot;AMSsymbols.js&quot;</span>, <span style="color: #BA2121">&quot;autobold.js&quot;</span>, <span
            style="color: #BA2121">&quot;color.js&quot;</span>]
  }
});
<span style="color: #008000; font-weight: bold">&lt;/script&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;script </span><span style="color: #7D9029">type=</span><span
            style="color: #BA2121">&quot;text/javascript&quot;</span> <span style="color: #7D9029">src=</span>
<span style="color: #BA2121">&quot;http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/script&gt;</span>

{% if user.is_anonymous() %}
  <span style="color: #008000; font-weight: bold">&lt;p</span> <span style="color: #7D9029">align=</span><span
            style="color: #BA2121">&quot;right&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;&lt;a</span> <span style="color: #7D9029">href=</span><span
            style="color: #BA2121">&quot;/login&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>Login<span
            style="color: #008000; font-weight: bold">&lt;/a&gt;</span>
  / <span style="color: #008000; font-weight: bold">&lt;a</span> <span style="color: #7D9029">href=</span><span
            style="color: #BA2121">&quot;/reg&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>Register<span
            style="color: #008000; font-weight: bold">&lt;/a&gt;&lt;/p&gt;</span>
{% else %}
  <span style="color: #008000; font-weight: bold">&lt;p</span> <span style="color: #7D9029">align=</span><span
            style="color: #BA2121">&quot;right&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>Logged in as {{user.username}}<span
            style="color: #008000; font-weight: bold">&lt;br&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;a</span> <span style="color: #7D9029">href=</span><span
            style="color: #BA2121">&quot;/old&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>Previous simulations<span
            style="color: #008000; font-weight: bold">&lt;a/&gt;&lt;br&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;a</span> <span style="color: #7D9029">href=</span><span
            style="color: #BA2121">&quot;/logout&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>Logout<span
            style="color: #008000; font-weight: bold">&lt;/a&gt;&lt;/p&gt;</span>
{% endif %}

This web page visualizes the function \(
u(t) = Ae^{-bt}\sin (w t), \hbox{ for } t\in [0,T]
\).

<span style="color: #008000; font-weight: bold">&lt;p&gt;</span>
<span style="color: #408080; font-style: italic">&lt;!-- Input and Results are typeset as a two-column table --&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;table&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;tr&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;td</span> <span style="color: #7D9029">valign=</span><span
            style="color: #BA2121">&quot;top&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;h2&gt;</span>Input:<span style="color: #008000; font-weight: bold">&lt;/h2&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;form</span> <span style="color: #7D9029">method=</span><span
            style="color: #BA2121">post</span> <span style="color: #7D9029">action=</span><span style="color: #BA2121">&quot;&quot;</span> <span
            style="color: #7D9029">enctype=</span><span style="color: #BA2121">multipart/form-data</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;table&gt;</span>
  {% for field in form %}
    <span style="color: #008000; font-weight: bold">&lt;tr&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>{{ field.label }}<span
            style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>{{ field(size=20) }}<span
            style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>
      {% if field.errors %}
        <span style="color: #008000; font-weight: bold">&lt;ul</span> <span style="color: #7D9029">class=</span><span
            style="color: #BA2121">errors</span><span style="color: #008000; font-weight: bold">&gt;</span>
        {% for error in field.errors %}
          <span style="color: #008000; font-weight: bold">&lt;li&gt;</span>{{ error }}<span
            style="color: #008000; font-weight: bold">&lt;/li&gt;</span>
        {% endfor %}<span style="color: #008000; font-weight: bold">&lt;/ul&gt;</span>
      {% endif %}
      <span style="color: #008000; font-weight: bold">&lt;/td&gt;&lt;/tr&gt;</span>
  {% endfor %}
<span style="color: #008000; font-weight: bold">&lt;/table&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;p&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;input</span> <span style="color: #7D9029">type=</span><span
            style="color: #BA2121">&quot;submit&quot;</span> <span style="color: #7D9029">value=</span><span
            style="color: #BA2121">&quot;Compute&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/p&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/form&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/td&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;td</span> <span style="color: #7D9029">valign=</span><span
            style="color: #BA2121">&quot;top&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
  {% if result != None %}
    <span style="color: #008000; font-weight: bold">&lt;h2&gt;</span>Results:<span
            style="color: #008000; font-weight: bold">&lt;/h2&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;img</span> <span style="color: #7D9029">src=</span><span
            style="color: #BA2121">&quot;data:image/png;base64,{{ result|safe }}&quot;</span> <span
            style="color: #7D9029">width=</span><span style="color: #BA2121">&quot;400&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
    {% if not user.is_anonymous() %}
      <span style="color: #008000; font-weight: bold">&lt;h3&gt;</span>Comments:<span
            style="color: #008000; font-weight: bold">&lt;/h3&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;form</span> <span style="color: #7D9029">method=</span><span
            style="color: #BA2121">&quot;post&quot;</span> <span style="color: #7D9029">action=</span><span
            style="color: #BA2121">&quot;/add_comment&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
          <span style="color: #008000; font-weight: bold">&lt;textarea</span> <span
            style="color: #7D9029">name=</span><span style="color: #BA2121">&quot;comments&quot;</span> <span
            style="color: #7D9029">rows=</span><span style="color: #BA2121">&quot;4&quot;</span> <span
            style="color: #7D9029">cols=</span><span style="color: #BA2121">&quot;40&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;&lt;/textarea&gt;</span>
          <span style="color: #008000; font-weight: bold">&lt;p&gt;&lt;input</span> <span
            style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;submit&quot;</span> <span
            style="color: #7D9029">value=</span><span style="color: #BA2121">&quot;Add&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;/form&gt;</span>
      {% endif %}

  {% endif %}
<span style="color: #008000; font-weight: bold">&lt;/td&gt;&lt;/tr&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/table&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/body&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/html&gt;</span>
</pre>
</div>
<p>
    The <code>login.html</code> template for the login page takes the form

<p>

    <!-- code=html (!bc htmlpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BC7A00">&lt;!DOCTYPE html&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;html</span> <span style="color: #7D9029">lang=</span><span
            style="color: #BA2121">&quot;en&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;head&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;meta</span> <span style="color: #7D9029">charset=</span><span
            style="color: #BA2121">&quot;utf-8&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;title&gt;</span>Flask Vib app<span
            style="color: #008000; font-weight: bold">&lt;/title&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/head&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;body&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;h2&gt;</span>Login:<span style="color: #008000; font-weight: bold">&lt;/h2&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;form</span> <span style="color: #7D9029">method=</span><span
            style="color: #BA2121">post</span> <span style="color: #7D9029">action=</span><span style="color: #BA2121">&quot;&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;table&gt;</span>
    {% for field in form %}
      <span style="color: #008000; font-weight: bold">&lt;tr&gt;&lt;td&gt;</span>{{ field.label }}<span
            style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
          <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>{{ field(size=20) }}<span
            style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
          <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>
            {% if field.errors %}
              <span style="color: #008000; font-weight: bold">&lt;ul</span> <span
            style="color: #7D9029">class=</span><span style="color: #BA2121">errors</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
              {% for error in field.errors %}
                <span style="color: #008000; font-weight: bold">&lt;li&gt;</span>{{ error }}<span
            style="color: #008000; font-weight: bold">&lt;/li&gt;</span>
              {% endfor %}<span style="color: #008000; font-weight: bold">&lt;/ul&gt;</span>
            {% endif %}<span style="color: #008000; font-weight: bold">&lt;/td&gt;&lt;/tr&gt;</span>
    {% endfor %}
  <span style="color: #008000; font-weight: bold">&lt;/table&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;p&gt;&lt;input</span> <span
            style="color: #7D9029">type=</span><span style="color: #BA2121">&quot;submit&quot;</span> <span
            style="color: #7D9029">value=</span><span style="color: #BA2121">&quot;Login&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/form&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/body&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/html&gt;</span>
</pre>
</div>
<p>
    The page for registering a new user has a simple template <code>reg.html</code>:

<p>

    <!-- code=html (!bc htmlpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BC7A00">&lt;!DOCTYPE html&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;html</span> <span style="color: #7D9029">lang=</span><span
            style="color: #BA2121">&quot;en&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;head&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;meta</span> <span style="color: #7D9029">charset=</span><span
            style="color: #BA2121">&quot;utf-8&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;title&gt;</span>Flask Vib app<span
            style="color: #008000; font-weight: bold">&lt;/title&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/head&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;body&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;h2&gt;</span>Register:<span
            style="color: #008000; font-weight: bold">&lt;/h2&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;form</span> <span style="color: #7D9029">method=</span><span
            style="color: #BA2121">post</span> <span style="color: #7D9029">action=</span><span style="color: #BA2121">&quot;&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;table&gt;</span>
   {% for field in form %}
     <span style="color: #008000; font-weight: bold">&lt;tr&gt;&lt;td&gt;</span>{{ field.label }}<span
            style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
         <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>{{ field(size=20) }}<span
            style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
          <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>
            {% if field.errors %}
              <span style="color: #008000; font-weight: bold">&lt;ul</span> <span
            style="color: #7D9029">class=</span><span style="color: #BA2121">errors</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
              {% for error in field.errors %}
                <span style="color: #008000; font-weight: bold">&lt;li&gt;</span>{{ error }}<span
            style="color: #008000; font-weight: bold">&lt;/li&gt;</span>
              {% endfor %}<span style="color: #008000; font-weight: bold">&lt;/ul&gt;</span>
            {% endif %}<span style="color: #008000; font-weight: bold">&lt;/td&gt;&lt;/tr&gt;</span>
   {% endfor %}
<span style="color: #008000; font-weight: bold">&lt;/table&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;p&gt;&lt;input</span> <span style="color: #7D9029">type=</span><span
            style="color: #BA2121">submit</span> <span style="color: #7D9029">value=</span><span style="color: #BA2121">Register</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/form&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/body&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/html&gt;</span>
</pre>
</div>
<p>
    The final file is <code>old.html</code> for retrieving old simulations:

<p>

    <!-- code=html (!bc htmlpro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BC7A00">&lt;!DOCTYPE html&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;html</span> <span style="color: #7D9029">lang=</span><span
            style="color: #BA2121">&quot;en&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;head&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;meta</span> <span style="color: #7D9029">charset=</span><span
            style="color: #BA2121">&quot;utf-8&quot;</span> <span style="color: #008000; font-weight: bold">/&gt;</span>
  <span style="color: #008000; font-weight: bold">&lt;title&gt;</span>Flask Vib app<span
            style="color: #008000; font-weight: bold">&lt;/title&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/head&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;body&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;script </span><span style="color: #7D9029">type=</span><span
            style="color: #BA2121">&quot;text/x-mathjax-config&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
MathJax.Hub.Config({
  TeX<span style="color: #666666">:</span> {
     equationNumbers<span style="color: #666666">:</span> {  autoNumber<span style="color: #666666">:</span> <span
            style="color: #BA2121">&quot;AMS&quot;</span>  },
     extensions<span style="color: #666666">:</span> [<span style="color: #BA2121">&quot;AMSmath.js&quot;</span>, <span
            style="color: #BA2121">&quot;AMSsymbols.js&quot;</span>, <span style="color: #BA2121">&quot;autobold.js&quot;</span>, <span
            style="color: #BA2121">&quot;color.js&quot;</span>]
  }
});
<span style="color: #008000; font-weight: bold">&lt;/script&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;script </span><span style="color: #7D9029">type=</span><span
            style="color: #BA2121">&quot;text/javascript&quot;</span>
 <span style="color: #7D9029">src=</span><span style="color: #BA2121">&quot;http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/script&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;h2&gt;</span>Previous simulations<span
            style="color: #008000; font-weight: bold">&lt;/h2&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;p</span> <span style="color: #7D9029">align=</span><span
            style="color: #BA2121">&quot;right&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;&lt;a</span> <span style="color: #7D9029">href=</span><span
            style="color: #BA2121">&quot;/&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>Back to index<span
            style="color: #008000; font-weight: bold">&lt;/a&gt;&lt;/p&gt;</span>
{% if data %}
  {% for post in data %}
    <span style="color: #008000; font-weight: bold">&lt;hr&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;table&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;tr&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;td</span> <span style="color: #7D9029">valign=</span><span
            style="color: #BA2121">&quot;top&quot;</span> <span style="color: #7D9029">width=</span><span
            style="color: #BA2121">&quot;30%&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;h3&gt;</span>Input<span
            style="color: #008000; font-weight: bold">&lt;/h3&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;table&gt;</span>
      {% for field in post.form %}
        <span style="color: #008000; font-weight: bold">&lt;tr&gt;&lt;td&gt;</span>{{ field.label }}:<span
            style="color: #999999; font-weight: bold">&amp;nbsp;</span><span style="color: #008000; font-weight: bold">&lt;/td&gt;</span>
            <span style="color: #008000; font-weight: bold">&lt;td&gt;</span>{{ field.data }}<span
            style="color: #008000; font-weight: bold">&lt;/td&gt;&lt;/tr&gt;</span>
      {% endfor %}
      <span style="color: #008000; font-weight: bold">&lt;/table&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/td&gt;&lt;td</span> <span style="color: #7D9029">valign=</span><span
            style="color: #BA2121">&quot;top&quot;</span> <span style="color: #7D9029">width=</span><span
            style="color: #BA2121">&quot;60%&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;h3&gt;</span>Results<span
            style="color: #008000; font-weight: bold">&lt;/h3&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;img</span> <span style="color: #7D9029">src=</span><span
            style="color: #BA2121">&quot;data:image/png;base64,{{ post.result|safe }}&quot;</span> <span
            style="color: #7D9029">width=</span><span style="color: #BA2121">&quot;400&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
    {% if True %}
      <span style="color: #008000; font-weight: bold">&lt;p&gt;</span>
      {{ comments }}
    {% endif %}
    <span style="color: #008000; font-weight: bold">&lt;/td&gt;&lt;td</span> <span style="color: #7D9029">valign=</span><span
            style="color: #BA2121">&quot;top&quot;</span> <span style="color: #7D9029">width=</span><span
            style="color: #BA2121">&quot;60%&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;p&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;form</span> <span style="color: #7D9029">method=</span><span
            style="color: #BA2121">&quot;POST&quot;</span> <span style="color: #7D9029">action=</span><span
            style="color: #BA2121">&quot;/delete/{{ post.id }}&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
      <span style="color: #008000; font-weight: bold">&lt;input</span> <span style="color: #7D9029">type=</span><span
            style="color: #BA2121">submit</span> <span style="color: #7D9029">value=</span><span style="color: #BA2121">&quot;Delete&quot;</span>
       <span style="color: #7D9029">title=</span><span
            style="color: #BA2121">&quot;Delete this post from database&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/form&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/td&gt;&lt;/tr&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;/table&gt;</span>
   {% endfor %}
   <span style="color: #008000; font-weight: bold">&lt;hr&gt;</span>
   <span style="color: #008000; font-weight: bold">&lt;center&gt;</span>
   <span style="color: #008000; font-weight: bold">&lt;form</span> <span style="color: #7D9029">method=</span><span
            style="color: #BA2121">&quot;POST&quot;</span> <span style="color: #7D9029">action=</span><span
            style="color: #BA2121">&quot;/delete/-1&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
     <span style="color: #008000; font-weight: bold">&lt;input</span> <span style="color: #7D9029">type=</span><span
            style="color: #BA2121">submit</span> <span style="color: #7D9029">value=</span><span style="color: #BA2121">&quot;Delete all&quot;</span><span
            style="color: #008000; font-weight: bold">&gt;</span>
   <span style="color: #008000; font-weight: bold">&lt;/form&gt;</span>
   <span style="color: #008000; font-weight: bold">&lt;/center&gt;</span>
{% else %}
  No previous simulations
{% endif %}
<span style="color: #008000; font-weight: bold">&lt;/body&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/html&gt;</span>
</pre>
</div>
<p>
    <div class="alert alert-block alert-warning alert-text-normal">
        <b>Warning.</b>
<p>

<ul>
    <li> Sending email from the app does not work.</li>
    <li> Storing comments does not work.</li>
</ul>
</div>


<p>

    <!-- begin inline comment -->
    <font color="red">(<b>hpl 1</b>: Check if an autogenerated app from <code>_generate_app.py</code> can send mail and
        store comments. Need a <code>compute</code> function that returns full HTML text then.)</font>
    <!-- end inline comment -->

<h3 id="___sec59">Resources </h3>

<p>
    Working with a database in Flask is described here:

<ul>
    <li><a href="http://pythonhosted.org/Flask-SQLAlchemy/quickstart.html" target="_self"><tt>http://pythonhosted.org/Flask-SQLAlchemy/quickstart.html</tt></a>,
    </li>
    <li><a href="http://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-iv-database" target="_self"><tt>http://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-iv-database</tt></a>,
    </li>
    <li><a href="https://flask-login.readthedocs.org/en/latest/" target="_self">The Flask login extension</a></li>
</ul>

<p>
    <!-- begin bottom navigation -->
<table style="width: 100%">
    <tr>
        <td>
            <div style="text-align: left;"><a href="._web4sa_plain016.html">&laquo; Previous</a></div>
        </td>
        <td>
            <div style="text-align: right;"><a href="._web4sa_plain018.html">Next &raquo;</a></div>
        </td>
    </tr>
</table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


<center style="font-size:80%">
    <!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

